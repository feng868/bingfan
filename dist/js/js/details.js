define(["jquery"],function(){return{init:function(){new Promise(function(s,i){$.ajax({type:"get",url:"../data/tejia.json",dataType:"json",success:function(i){i=i.tejia,s(i)},error:function(i){console.log(i)}})}).then(function(a){if(location.href.split("?")[1])t=location.href.split("?")[1].split("_")[0];else var t=location.href.split("?");for(var n="",i="",s="",l=0;l<a.length;l++)for(var e in a[l])if(t==a[l][e]){n+='<div class="details-fdj"><div class="StlCont-left" id="fangdajing"><div class="StlCont-left-MaxImg "><img src="'+a[l].img+'" id="Img" /><div class="fitter "></div></div><div class="box"><img src="'+a[l].img+'" id="MaxImg" /></div><div class="StlCont-left-MinImg"><a href="##"><img src="'+a[l].pic[0]+'" data-url="'+a[l].pic[0]+'" /></a><a href="##"><img src="'+a[l].pic[1]+'" data-url="'+a[l].pic[1]+'" /></a><a href="##"><img src="'+a[l].pic[2]+'" data-url="'+a[l].pic[2]+'" /></a><a href="##"><img src="'+a[l].pic[0]+'" data-url="'+a[l].pic[0]+'" /></a></div></div><div class="details-icon"><ul><b>分享到：</b><li><span><i class="iconfont icon-weibo"></i>微博</span><span><i class="iconfont icon-weibo"></i>微博</span></li><li><span><i class="iconfont icon-kongjian"></i>空间</span><span><i class="iconfont icon-kongjian"></i>空间</span></li><li><span><i class="iconfont icon-qq"></i>QQ</span><span><i class="iconfont icon-qq"></i>QQ</span></li></ul></div></div><div class="details-message"><div><span><i></i>美国直邮</span><h3>'+a[l].miaoshu+"</h3></div><div><ul><li><span>活动价</span><span>"+a[l].price+"</span><span>优惠83.82元</span></li><li><span>优　　惠</span><span>精选商品额外7折</span></li><li><span>原　　价</span><span><s>"+a[l].sprice+'</s></span><span>7.0折</span></li><li><span>美国运费</span><span>￥32.74</span><span>（2018年12月02日结束：拉夫劳伦官网全场满884.04元免美国运费）</span></li><li><span>发货商家</span><span>由发货，预计10-20个工作日抵达</span><span>直达官网链接 </span></li><li><span>国际运费</span><span>￥66（预估单件发货重量780g）</span><span>详情</span></li></ul></div><div><ul><li class="color"><span>颜　　色</span><i></i></li><li class="size"><span>尺　　寸</span><i></i></li><li><span>数　　量</span><i class="sub">-</i><input type="text" value="1" class="num"/><i class="add">+</i></li><li><span>已   选   择</span><span class="select-color"></s></span><span class="select-size"> </span></li></ul></div><div><p><button class="details-btn">加入购物车</button><span>收藏商品</span><span>手机购买</span></p><p><span><i></i>海外正品官网采购</span><span><i></i>极速送达超时赔付</span><span><i></i>国际物流全程跟踪</span><span><i></i>七天包退无忧海淘</span></p></div></div><div class="details-like"></div>';for(var o=0;o<a[l].color.length;o++)i+="<span>"+a[l].color[o]+"</span>";for(o=0;o<a[l].size.length;o++)s+="<span>"+a[l].size[o]+"</span>"}$(".details-box").html(n),$(".details-message>div .color>i").html(i),$(".details-message>div .color>i>span").click(function(){$(this).css("border","1px solid #F54401").siblings().css("border","1px solid #ccc");var i=$(this).text();$(".select-color").text(i);var s=location.href.split("_")[0]+"_"+i;history.pushState("","",s)}),$(".details-message>div .size>i").html(s),$(".details-message>div .size>i>span").click(function(){$(this).css("border","1px solid #F54401").siblings().css("border","1px solid #ccc");var i=$(this).text();$(".select-size").text(i);var s=location.href.split("__")[0]+"__"+$(this).index();history.pushState("","",s)}),$(".box>img").attr({height:1.5*$(".StlCont-left-MaxImg>img").height(),width:600}),$(".StlCont-left-MinImg>a>img").hover(function(){var i=$(this).attr("data-url");$(".StlCont-left-MaxImg>img").attr("src",i);var s=$(".StlCont-left-MaxImg>img").height(),a=$(".StlCont-left-MaxImg>img").width();$(".box>img").attr({src:i,width:1.5*a,height:1.5*s})},function(){}),$(".StlCont-left-MaxImg").hover(function(){$(".StlCont-left-MaxImg .fitter").css("display","block"),$(".box").css("display","block")},function(){$(".box").css("display","none"),$(".StlCont-left-MaxImg .fitter").css("display","none")}),$.fn.magnifying=function(){var i=$(this),l=i.find(".StlCont-left-MaxImg"),e=(l.find("img"),i.find(".fitter")),s=i.find(".box"),o=s.find("img"),c=s.width()/e.width();l.mousemove(function(i){var s=i.pageX-$(this).offset().left-e.width()/2,a=i.pageY-$(this).offset().top-e.height()/2,t=l.width()-e.width(),n=l.height()-e.height();s=(s=0<s?s:0)<t?s:t,a=(a=0<a?a:0)<n?a:n,e.css({left:s+"px",top:a+"px"}),o.css({marginLeft:-c*s+"px",marginTop:-c*a+"px"})})},$("#fangdajing").magnifying(),$(".sub").click(function(){var i=$(this).next().val();i<=1?i=1:i--,$(this).next().val(i)}),$(".add").click(function(){var i=$(this).prev().val();i++,$(this).prev().val(i)});var c={},p=1;$(".details-btn").click(function(){var i=$(".num").val();localStorage.num&&(c=JSON.parse(localStorage.num)),c[t]?(p+=Number(i),c[t]=p):(c[t]=i,console.log(c));var s=JSON.stringify(c);localStorage.num=s,1==($(".select-color").text()+$(".select-size").text()).length?alert("选择颜色大小"):location.href="cart.html?"+location.href.split("?")[1]});var r=n="";$(".search>form>input").keyup(function(){for(var i=$(this).val(),s=0;s<a.length;s++)-1!=a[s].miaoshu.indexOf(i)&&(r="<ul></ul>",n+="<li data-id="+a[s].id+">"+a[s].miaoshu+"</li>",""==i&&(r=n=""));$(".search>form>.search-list").html(r),$(".search>form>.search-list>ul").html(n),$(".search>form>.search-list>ul>li").click(function(){$(".search>form>input").val($(this).html());var i=$(this).attr("data-id");$(".search>form>input").attr("data-id",i)})}),$(".search-btn").click(function(){var i=$(".search>form>input").attr("data-id");$(".search>form>input").removeAttr("data-id"),location.href="details.html?"+i})})}}});